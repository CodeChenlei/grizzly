
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2018-04-11
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Project Grizzly - AJP Overview</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="//netdna.bootstrapcdn.com/bootswatch/2.2.2/cosmo/bootstrap.min.css" rel="stylesheet" />
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="https://javaee.github.io/grizzly//css/bootswatch.css" rel="stylesheet" />
		<link href="https://javaee.github.io/grizzly//css/reflow-skin.css" rel="stylesheet" />
		
		<link href="//yandex.st/highlightjs/7.3/styles/solarized_dark.min.css" rel="stylesheet" />
		
		<link href="https://javaee.github.io/grizzly//css/lightbox.css" rel="stylesheet" />
		
		<link href="https://javaee.github.io/grizzly//css/site.css" rel="stylesheet" />
		<link href="https://javaee.github.io/grizzly//css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

	</head>

	<body class="page-ajp project-site" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html">Project <span class="color-brown">Grizzly</span></a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="dependencies.html" title="Download">Download </a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="overview.html" title="Overview">Overview </a></li>
									<li><a href="dependencies.html" title="Dependencies">Dependencies </a></li>
									<li class="dropdown-submenu">
										<a href="hack" title="Core Framework">Core Framework </a>
										<ul class="dropdown-menu">
											<li><a href="memory.html" title="Memory Management">Memory Management </a></li>
											<li><a href="iostrategies.html" title="I/O Strategies">I/O Strategies </a></li>
											<li><a href="transportsconnections.html" title="Transports and Connections">Transports and Connections </a></li>
											<li><a href="filterchainfilters.html" title="FilterChain and Filters">FilterChain and Filters </a></li>
											<li><a href="coreconfig.html" title="Core configuration">Core configuration </a></li>
											<li><a href="portunification.html" title="Port Unification">Port Unification </a></li>
											<li><a href="monitoring.html" title="Monitoring">Monitoring </a></li>
											<li><a href="extras.html" title="Extras">Extras </a></li>
											<li><a href="bestpractices.html" title="Best Practices">Best Practices </a></li>
											<li><a href="quickstart.html" title="Quick Start">Quick Start </a></li>
											<li><a href="samples.html" title="Samples">Samples </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="hack" title="HTTP">HTTP </a>
										<ul class="dropdown-menu">
											<li><a href="httpframework.html" title="Core HTTP Framework">Core HTTP Framework </a></li>
											<li><a href="httpserverframework.html" title="HTTP Server Framework">HTTP Server Framework </a></li>
											<li><a href="http2.html" title="HTTP/2">HTTP/2 </a></li>
											<li><a href="httpserverframeworkextras.html" title="HTTP Server Framework Extras">HTTP Server Framework Extras </a></li>
											<li><a href="comet.html" title="Comet">Comet </a></li>
											<li><a href="jaxws.html" title="JAXWS">JAXWS </a></li>
											<li><a href="websockets.html" title="WebSockets">WebSockets </a></li>
											<li class="active"><a href="" title="AJP">AJP </a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	<header class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="index.html" id="bannerLeft"><h1><img src="images/grizzlyHead.png"/>&nbsp;<span class="color-black">Project</span> Grizzly</h1></a>
					<p class="lead">NIO Event Development Simplified</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
		<div>
			<ul class="breadcrumb">
				<li class="publishDate version-date">Last Published: 2018-04-11</li>
			</ul>
		</div>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<ul id="toc" class="nav">
						<li class="toplevel"><a href="#AJP_Overview" title="AJP Overview">AJP Overview</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#How_it_works" title="How it works">How it works</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#AJP_Configuration" title="AJP Configuration">AJP Configuration</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#Sample" title="Sample">Sample</a></li>
					</ul>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="AJP_Overview">AJP Overview</h2>
 </div> 
 <p>Starting with version 2.1, Grizzly supports <a class="externalLink" href="http://en.wikipedia.org/wiki/Apache_JServ_Protocol">AJP</a> 1.3 (Apache JServ Protocol) natively. “Natively” means AJP is implemented using core Grizzly APIs and naturally fits into entire Grizzly infrastructure: memory management, threading etc…</p> 
</div> 
<div class="section"> 
 <h2 id="How_it_works">How it works</h2> 
 <p>The AJP protocol implementation is mainly represented by two Filters: AjpMessageFilter, AjpHandlerFilter. The AjpMessageFilter is responsible for constructing AJP protocol messages and AjpHandlerFilter contains the actual processing logic, which works as a codec between AJP and HTTP messages. All the Filters upstream to AjpHandlerFilter receive HTTP messages for processing, so they are not even aware of AJP protocol.</p> 
 <p>Here is a FilterChain, which is being normally constructed, when Grizzly HttpServer being used:</p> 
 <p><img src="images/ajp/httpserver-filterchain.png" alt="&quot;&quot;" /></p> 
 <p>Now, what happens, if we want to use AJP? It’s easy, we replace HTTP Filter, which works as a codec for Buffer &lt;-&gt; HTTP transformation, with the two Filters mentioned above: AjpMessageFilter and AjpHandlerFilter:</p> 
 <p><img src="images/ajp/httpserver-ajp-filterchain.png" alt="&quot;&quot;" /></p> 
 <p>So the Grizzly HttpServer Filter won’t even notice it operates over AJP rather than plain HTTP.</p> 
 <p>In order to simplify HttpServer AJP configuration, there is an AjpAddOn available, which may be registered on the required HttpServer’s NetworkListener like:</p> 
 <div class="source"> 
  <pre>HttpServer httpServer = new HttpServer();
NetworkListener listener =
         new NetworkListener(&quot;grizzly&quot;,
         NetworkListener.DEFAULT_NETWORK_HOST, PORT);

AjpAddOn ajpAddon = new AjpAddOn();
listener.registerAddOn(ajpAddon);

httpServer.addListener(listener);
</pre> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="AJP_Configuration">AJP Configuration</h2> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <caption>
    AjpHandlerFilter and AjpAddOn Properties 
  </caption> 
  <tbody> 
   <tr class="odd"> 
    <td align="left">isTomcatAuthentication</td> 
    <td align="left">If set to true, the authentication will be done in Grizzly. Otherwise, the authenticated principal will be propagated from the native webserver and used for authorization in Grizzly. The default value is true.</td> 
   </tr> 
   <tr class="even"> 
    <td align="left">secret</td> 
    <td align="left">If not null, only requests from workers with this secret keyword will be accepted, null means no secret check will be done.</td> 
   </tr> 
   <tr class="odd"> 
    <td align="left">shutdownHandlers</td> 
    <td align="left">The set of ShutdownHandlers, which will be invoked, when AJP shutdown request received. The implementation itself doesn't perform any action related to shutdown request.</td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="Sample">Sample</h2> 
 <p>There is a simple AJP “Hello World” sample available, which contains a single class, single HttpHandler, which is accessible via AJP and HTTP at the same time. Here is the most interesting part of it responsible for HttpServer initialization.</p> 
 <div class="source"> 
  <pre>final HttpServer server = new HttpServer();

// Create plain HTTP listener, which will handle port 8080
final NetworkListener httpNetworkListener =
        new NetworkListener(&quot;http-listener&quot;, &quot;0.0.0.0&quot;, 8080);

// Create AJP listener, which will handle port 8009
final NetworkListener ajpNetworkListener =
        new NetworkListener(&quot;ajp-listener&quot;, &quot;0.0.0.0&quot;, 8009);
// Register AJP addon on HttpServer's listener
ajpNetworkListener.registerAddOn(new AjpAddOn());

server.addListener(httpNetworkListener);
server.addListener(ajpNetworkListener);

final ServerConfiguration config = server.getServerConfiguration();

// Map the path, /grizzly, to the HelloWorldHandler
config.addHttpHandler(new HelloWorldHandler(), &quot;/grizzly&quot;);
</pre> 
 </div> 
 <p>The <a class="externalLink" href="https://github.com/javaee/grizzly/blob/2.3.x/samples/http-ajp-samples/readme.txt">readme.txt</a> contains setup and run instructions.</p> 
 <p>Complete sources and instructions could be found <a class="externalLink" href="https://github.com/javaee/grizzly/tree/2.3.x/samples/http-ajp-samples">here</a>.</p> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="license.html" title="License">License </a>
						</li>
						<li>
							<a href="using.html" title="Who's Using Grizzly">Who's Using Grizzly </a>
						</li>
						<li class="nav-header">Download</li>
						<li>
							<a href="dependencies.html" title="Download">Download </a>
						</li>
					</ul>
				</div>
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="contribute.html" title="Contribute">Contribute </a>
						</li>
						<li>
							<a href="http://stackoverflow.com/questions/tagged/grizzly" title="StackOverflow" class="externalLink">StackOverflow </a>
						</li>
						<li>
							<a href="https://twitter.com/project_grizzly" title="Twitter" class="externalLink">Twitter </a>
						</li>
						<li>
							<a href="mailing.html" title="Mailing Lists">Mailing Lists </a>
						</li>
					</ul>
				</div>
				<div class="span4 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
				<div class="span0 bottom-description">
					<blockquote><div id="archive-footer">This project is now part of the <a href="https://projects.eclipse.org/projects/ee4j">EE4J</a> initiative; its activity is temporarily paused until it has been effectively transferred to the Eclipse Foundation.<br/>See <a href="https://www.eclipse.org/ee4j/status.php">here</a> for the EE4J transition status.
</div></blockquote>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2018. All Rights Reserved.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='https://javaee.github.io/grizzly//js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<script src="https://javaee.github.io/grizzly//js/lightbox.js"></script>
	<script src="https://javaee.github.io/grizzly//js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="https://javaee.github.io/grizzly//js/jquery.ba-bbq.min.js"></script>
	<script src="//yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="https://javaee.github.io/grizzly//js/reflow-skin.js"></script>
	
	</body>
</html>
